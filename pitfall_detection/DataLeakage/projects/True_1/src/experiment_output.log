DatasetDict({
    train: Dataset({
        features: ['id', 'sequence', 'label'],
        num_rows: 20000
    })
    dev: Dataset({
        features: ['id', 'sequence', 'label'],
        num_rows: 5000
    })
    test: Dataset({
        features: ['id', 'sequence', 'label'],
        num_rows: 10000
    })
})
Using device: cpu
Generating synthetic datasets with hidden rules:
  - Exactly two tokens must have shape 'â–²' and texture 'solid'.
  - The token at position 4 must have color 'r'.
Model instantiated on device: cpu

=== Starting Training Experiment for SPR Task ===
This experiment trains a multi-modal transformer model that fuses shape, color, and texture embeddings with positional encoding.
It evaluates two aspects:
  1. SPR classification performance (binary decision) based on the hidden rules.
  2. Extraction of interpretable soft symbolic predicates via a symbolic reasoning head.
The training loss is computed as the sum of binary cross-entropy loss and an L1 sparsity loss on the symbolic outputs.

Epoch 1: Training Loss = 0.1612, Dev Accuracy = 94.80%
Epoch 2: Training Loss = 0.1504, Dev Accuracy = 94.80%
Epoch 3: Training Loss = 0.1494, Dev Accuracy = 94.80%
Epoch 4: Training Loss = 0.1156, Dev Accuracy = 94.80%
Epoch 5: Training Loss = 0.0816, Dev Accuracy = 94.60%

=== Test Evaluation ===
This evaluation measures the overall SPR classification performance on unseen test data.
Predictions are derived by applying a threshold (0.5) to the sigmoid-transformed outputs of the classifier head.

Test Accuracy: 94.20%  (SPR classification performance on unseen data)

Generating Figure_1.png
Figure_1.png plots the training loss over epochs. This figure demonstrates the convergence behavior of the model as it minimizes the combined loss (classification + sparsity).

Generating Figure_2.png
Figure_2.png presents the development set accuracy over epochs, illustrating improvements in the SPR classification performance during training.

Training and evaluation completed successfully.
Figures 'Figure_1.png' and 'Figure_2.png' have been generated to visualize training dynamics and performance improvements.
