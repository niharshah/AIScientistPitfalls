import matplotlib.pyplot as plt
import numpy as np

We will load experiment_data.npy from the working directory, iterate over every top-level dataset key present, and for each dataset: (1) extract epochs plus train/validation losses and F1; (2) generate three plots—loss curves, validation-F1 curve, and a confusion matrix on the test split—each wrapped in its own try-except block so failures don’t crash the script; (3) save figures with descriptive filenames that include dataset name and plot type; (4) always close figures. We cap epochs-based plots at the available epochs (≤ 15) and only plot values that actually exist in the data structure. For datasets that have no predictions or ground-truth, the confusion-matrix block is skipped. After plotting, we compute and print the final macro-F1 for any dataset that contains both preds and gts, giving a quick numerical summary alongside the visuals. All figures are stored under working_dir so the environment remains self-contained. The code starts with the required imports and creates working_dir if it is missing.