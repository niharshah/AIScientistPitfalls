Loaded train split with 20000 records.
Loaded dev split with 5000 records.
Loaded test split with 10000 records.

Dataset splits available: ['train', 'dev', 'test']

First training example:
ID: SPR_train_0
Sequence: ●y ●g ●r ■r ▲y ▲g
Label: 0
Unique Shapes Count: 3
Unique Colors Count: 3
Using device: cpu

Step 1: Data Preprocessing
Unique Shapes Vocabulary: {'■': 0, '▲': 1, '◆': 2, '●': 3}
Processed development data with 5000 samples.
Processed test data with 10000 samples.

Step 2: Model Building and Training

Training the model on the training split and tuning on the development split.
Epoch 1/20: Training Loss = 0.7351, Dev Accuracy = 59.42%
Epoch 2/20: Training Loss = 0.6826, Dev Accuracy = 66.66%
Epoch 3/20: Training Loss = 0.6528, Dev Accuracy = 53.78%
Epoch 4/20: Training Loss = 0.6418, Dev Accuracy = 60.12%
Epoch 5/20: Training Loss = 0.6403, Dev Accuracy = 61.04%
Epoch 6/20: Training Loss = 0.6393, Dev Accuracy = 61.04%
Epoch 7/20: Training Loss = 0.6333, Dev Accuracy = 61.14%
Epoch 8/20: Training Loss = 0.6237, Dev Accuracy = 58.82%
Epoch 9/20: Training Loss = 0.6131, Dev Accuracy = 57.84%
Epoch 10/20: Training Loss = 0.6022, Dev Accuracy = 57.28%
Epoch 11/20: Training Loss = 0.5941, Dev Accuracy = 61.50%
Epoch 12/20: Training Loss = 0.5878, Dev Accuracy = 77.40%
Epoch 13/20: Training Loss = 0.5829, Dev Accuracy = 74.88%
Epoch 14/20: Training Loss = 0.5788, Dev Accuracy = 74.58%
Epoch 15/20: Training Loss = 0.5744, Dev Accuracy = 74.58%
Epoch 16/20: Training Loss = 0.5691, Dev Accuracy = 74.58%
Epoch 17/20: Training Loss = 0.5626, Dev Accuracy = 77.28%
Epoch 18/20: Training Loss = 0.5551, Dev Accuracy = 78.62%
Epoch 19/20: Training Loss = 0.5483, Dev Accuracy = 79.56%
Epoch 20/20: Training Loss = 0.5420, Dev Accuracy = 79.56%

Loaded best model from dev set with accuracy 79.56%.

Figure_1.png saved: Training loss curve showing loss reduction over epochs.

Step 3: Testing and Evaluation

Detailed Experimental Results:
 - Standard Test Accuracy: 61.84%
 - Shape-Weighted Accuracy (SWA): 61.84%

Figure_2.png saved: Bar chart comparing the SOTA baseline (75% SWA) with our model's SWA.

Final Results Summary:
Our model achieved a Standard Test Accuracy of 61.84% and a Shape-Weighted Accuracy of 61.84% on the SPR_BENCH test set.
