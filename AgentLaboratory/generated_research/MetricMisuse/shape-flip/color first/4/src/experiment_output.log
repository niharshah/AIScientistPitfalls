Loaded SPR_BENCH splits: ['train', 'dev', 'test']
Example from train split:
{'id': 'SPR_train_0', 'sequence': '●y ●g ●r ■r ▲y ▲g', 'label': 0, 'color_variety': 3, 'shape_variety': 3}
Loaded SPR_BENCH splits: ['train', 'dev', 'test']
Example from train split:
{'id': 'SPR_train_0', 'sequence': '●y ●g ●r ■r ▲y ▲g', 'label': 0, 'color_variety': 3, 'shape_variety': 3}

Starting training.
This experiment demonstrates a graph-based relational symbolic pattern recognition (SPR) model.
Each sequence is converted into a directed graph where each token is a node with an 8-dimensional one-hot feature (4 for shape, 4 for color).
Directed edges (from token i to token j for i<j) capture inter-token relationships.
A Graph Attention mechanism aggregates messages from neighbor nodes, and the node embeddings are mean-pooled to obtain a graph-level representation.
An iterative refinement step is applied to the graph representation via a differentiable logic head, nudging the representation towards satisfying a target logic value of 1.
The final logit is computed as: final_logit = class_logit + logic_beta * logic_score.
Training minimizes a combined loss: binary cross-entropy and a logic consistency loss. Metrics include overall accuracy, Color-Weighted Accuracy (CWA), and Shape-Weighted Accuracy (SWA).

Epoch 1/5 - Avg Training Loss: 0.6851 | Dev Accuracy: 62.42% | Dev CWA: 62.00% | Dev SWA: 62.50%
Epoch 2/5 - Avg Training Loss: 0.6630 | Dev Accuracy: 62.08% | Dev CWA: 61.47% | Dev SWA: 61.39%
Epoch 3/5 - Avg Training Loss: 0.6539 | Dev Accuracy: 64.06% | Dev CWA: 63.62% | Dev SWA: 63.71%
Epoch 4/5 - Avg Training Loss: 0.6479 | Dev Accuracy: 63.90% | Dev CWA: 63.47% | Dev SWA: 63.32%
Epoch 5/5 - Avg Training Loss: 0.6429 | Dev Accuracy: 61.94% | Dev CWA: 61.54% | Dev SWA: 61.02%

Final Evaluation on Test set:
This evaluation measures overall accuracy and weighted metrics (CWA and SWA) on unseen test data.
It demonstrates the model's capacity to correctly classify SPR sequences with diverse color and shape complexities.
Reference SOTA: CWA ~65.0%, SWA ~70.0%.

Test Accuracy: 59.58%
Test Color-Weighted Accuracy (CWA): 59.85% (Baseline SOTA ~65.0%)
Test Shape-Weighted Accuracy (SWA): 57.92% (Baseline SOTA ~70.0%)
Model achieved non-zero accuracy on the test split.

Figure_1.png saved: Training Loss Curve.
Figure_2.png saved: Development Accuracy Curve.

All experiments completed successfully.
